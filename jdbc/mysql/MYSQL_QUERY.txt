SHOW DATABASES;
use emp;
show tables;
describe emp;

//SELECT procedure
DELIMITER &&  
CREATE PROCEDURE EMPprocedure()  
BEGIN  
    SELECT * FROM EMP WHERE SALARY > 50000;     
END &&  
DELIMITER ;

//insert procedure
DELIMITER && 

CREATE PROCEDURE empinsert(IN ID VARCHAR(10), IN NAME VARCHAR(10), IN SALARY VARCHAR(10))

BEGIN  
    
	INSERT INTO EMP(ID,NAME,SALARY) VALUES (ID,NAME,SALARY);

END &&

DELIMITER ; 

//update procedure
DELIMITER &&

CREATE PROCEDURE empupdate(IN ID VARCHAR(10), IN SALARY VARCHAR(10))

BEGIN  
	
	UPDATE EMP SET SALARY = SALARY WHERE ID = ID;
END &&

DELIMITER ; 

//delete procedure
DELIMITER &&

CREATE PROCEDURE empdelete(IN ID VARCHAR(10))

BEGIN  
	
	DELETE FROM EMP WHERE ID = ID;

END &&

DELIMITER ; 

//OUT
DELIMITER &&

CREATE PROCEDURE emppOUT(OUT COUNT_ID INT)

BEGIN  
	
	SELECT COUNT(ID) INTO COUNT_ID FROM EMP WHERE SALARY > '80000';
END &&

DELIMITER ; 

//INOUT
DELIMITER &&

CREATE PROCEDURE emppINOUT(INOUT COUNT_ID INT, IN EMP_SALARY VARCHAR(10))

BEGIN  
	
	SELECT COUNT(ID) INTO COUNT_ID FROM EMP WHERE SALARY > EMP_SALARY  ;
END &&

DELIMITER ; 


//FUNCTION

//MUL
USE `emp`;

DROP function IF EXISTS `mul`;


DELIMITER $$

CREATE FUNCTION mul(A INT, B INT)

RETURNS INTEGER

DETERMINISTIC 
BEGIN

	DECLARE C INT;

	SET C = A*B;

RETURN C;

END$$


DELIMITER ;

//ADD

DELIMITER $$

CREATE FUNCTION ADD(A INT, B INT)

RETURNS INTEGER

DETERMINISTIC 
BEGIN

	DECLARE C INT;

	SET C = A+B;

RETURN C;

END$$


DELIMITER ;

//DIV

DELIMITER $$

CREATE FUNCTION DIV(A INT, B INT)

RETURNS INTEGER

DETERMINISTIC 
BEGIN

	DECLARE C INT;

	SET C = A/B;

RETURN C;

END$$


DELIMITER ;

//SUB

DELIMITER $$

CREATE FUNCTION SUB(A INT, B INT)

RETURNS INTEGER

DETERMINISTIC 
BEGIN

	DECLARE C INT;

	SET C = A-B;

RETURN C;

END$$


DELIMITER ;


//FACTORIAL
DELIMITER $$
CREATE FUNCTION fact(x int)
RETURNS INTEGER
DETERMINISTIC

BEGIN

	declare result INT;

    	declare i INT;

	set result = 1;

	set i = 1;

    	while i<=x do
	
set result = result *i;
    
	set i = i+1;
    
	end while;

RETURN result;

END $$


DELIMITER ;

//CALL
SELECT FACT(5);





